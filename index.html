<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagar Nusa Kemang - Pagar NU dan Bangsa</title>
    <meta name="description" content="Media Resmi PAC Pagar Nusa Kecamatan Kemang - Kabupaten Bogor. Menyajikan berita terkini, opini, dan khazanah pencak silat NU.">
    <meta name="author" content="Infokom Pagar Nusa Kemang">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --pn-green: #2d6a4f; --pn-dark: #1b4332; --pn-light: #d8f3dc; }
        body { font-family: 'Roboto', sans-serif; scroll-behavior: smooth; }
        .nav-font { font-family: 'Oswald', sans-serif; }
        .bg-pn { background-color: var(--pn-green); }
        .text-pn { color: var(--pn-green); }
        .border-pn { border-color: var(--pn-green); }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        /* Optimized Shimmer */
        .shimmer { 
            background: linear-gradient(90deg, #f0f0f0 25%, #e6e6e6 50%, #f0f0f0 75%); 
            background-size: 200% 100%; 
            animation: shimmer 1.5s infinite linear; 
        }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }

        .news-card { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .news-card:hover { transform: translateY(-5px); }
        
        /* Reveal Animation */
        .reveal { opacity: 0; transform: translateY(20px); transition: all 0.6s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: var(--pn-green); border-radius: 10px; }

        /* Mobile Menu */
        #mobile-menu { transition: transform 0.3s ease-in-out; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 selection:bg-pn selection:text-white">

    <div id="top-bar" class="bg-gray-100 py-2 text-[10px] text-center uppercase tracking-[0.2em] text-gray-500 font-bold border-b">
        Media Resmi PAC Pagar Nusa Kecamatan Kemang - Kabupaten Bogor
    </div>

    <header class="bg-white py-6 border-b border-gray-50 sticky top-[-1px] z-[60] shadow-sm md:static">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div id="menu-toggle" class="text-3xl cursor-pointer hover:text-pn transition md:hidden">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
            </div>

            <div class="flex items-center space-x-3 mx-auto md:mx-0">
                <img src="https://lh3.googleusercontent.com/d/1drM76LlU3sdqpwo-Urq7ZULoyORC0UMQ" alt="Logo" class="h-14 md:h-16 drop-shadow-sm transition-transform hover:rotate-6">
                <div class="text-left">
                    <h1 class="text-3xl md:text-4xl font-bold text-pn tracking-tighter leading-none nav-font uppercase">Pagar Nusa</h1>
                    <p class="text-pn italic font-medium text-sm md:text-lg leading-tight tracking-tight">Pagar NU dan Bangsa</p>
                </div>
            </div>

            <div class="relative group hidden md:block">
                <input id="search-input" type="text" placeholder="Cari berita..." class="absolute right-10 top-1/2 -translate-y-1/2 bg-gray-100 border-none rounded-full px-4 py-1.5 text-sm focus:ring-2 focus:ring-pn outline-none transition-all w-0 group-hover:w-64 focus:w-64 shadow-inner">
                <div class="text-3xl cursor-pointer hover:text-pn transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-800" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                </div>
            </div>
        </div>
    </header>

    <nav class="bg-pn sticky top-0 z-50 shadow-lg hidden md:block">
        <div class="container mx-auto">
            <ul id="main-nav" class="flex flex-wrap justify-center items-center text-white nav-font uppercase tracking-widest text-sm py-1">
                <li class="px-6 py-4 animate-pulse">Memuat Menu...</li>
            </ul>
        </div>
    </nav>

    <div id="mobile-menu" class="fixed inset-y-0 left-0 w-64 bg-pn z-[70] transform -translate-x-full shadow-2xl md:hidden">
        <div class="p-6">
            <div class="flex justify-between items-center border-b border-white/20 pb-4">
                <h2 class="text-white font-bold nav-font text-xl">MENU</h2>
                <div id="close-menu" class="text-white cursor-pointer">✕</div>
            </div>
            <ul id="mobile-nav-list" class="mt-4 text-white space-y-4 nav-font uppercase tracking-wider text-lg"></ul>
        </div>
    </div>
    <div id="overlay" class="fixed inset-0 bg-black/50 z-[65] hidden md:hidden"></div>

    <main class="container mx-auto px-4 py-8">
        <div id="headline-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-12">
            <div class="h-[400px] shimmer rounded-xl"></div>
            <div class="h-[400px] shimmer rounded-xl"></div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
            <div class="lg:col-span-2">
                <div class="flex items-center justify-between border-b-4 border-pn mb-8">
                    <h3 id="news-title-trigger" class="text-2xl font-bold inline-block py-2 uppercase nav-font tracking-wide">Berita Terkini</h3>
                    <div id="search-status" class="text-xs text-gray-400 font-bold italic"></div>
                </div>
                
                <div id="news-list" class="space-y-10">
                    <div class="flex flex-col md:flex-row gap-6 animate-pulse">
                        <div class="md:w-64 h-44 bg-gray-200 rounded-xl"></div>
                        <div class="flex-1 space-y-4">
                            <div class="h-4 bg-gray-200 w-1/4 rounded"></div>
                            <div class="h-8 bg-gray-200 w-3/4 rounded"></div>
                            <div class="h-16 bg-gray-200 w-full rounded"></div>
                        </div>
                    </div>
                </div>
            </div>

            <aside class="space-y-10">
                <div class="reveal">
                    <h3 class="text-2xl font-bold border-b-4 border-pn inline-block mb-6 uppercase nav-font text-center w-full">Opini & Khazanah</h3>
                    <div class="bg-white shadow-[0_10px_30px_rgba(0,0,0,0.05)] p-6 border border-gray-100 rounded-2xl">
                        <ul id="opinion-list" class="divide-y divide-gray-100"></ul>
                    </div>
                </div>

                <div class="reveal bg-pn p-8 text-white text-center rounded-2xl shadow-2xl border-b-8 border-green-900 transition-all hover:translate-y-[-5px]">
                    <div class="bg-white/20 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                    </div>
                    <h4 class="nav-font text-2xl mb-2 font-bold uppercase tracking-wider">Sekretariat PAC</h4>
                    <p id="alamat-sekre" class="text-sm opacity-90 leading-relaxed min-h-[60px]">Memuat data alamat...</p>
                    <a id="btn-wa" href="#" target="_blank" class="inline-block mt-6 px-10 py-4 bg-white text-pn font-bold rounded-full text-xs uppercase tracking-widest hover:bg-yellow-400 hover:text-pn transition-all transform active:scale-95 shadow-lg">Hubungi Kami</a>
                </div>
            </aside>
        </div>
    </main>

    <footer class="bg-white border-t-8 border-pn py-16 mt-20 text-center text-gray-500 text-xs">
        <div class="container mx-auto px-4">
            <img src="https://lh3.googleusercontent.com/d/1drM76LlU3sdqpwo-Urq7ZULoyORC0UMQ" class="h-24 mx-auto mb-6 opacity-80 filter grayscale hover:grayscale-0 transition duration-700">
            <p class="font-bold text-pn text-2xl nav-font uppercase mb-2 tracking-[0.3em]">PAC Pagar Nusa Kemang</p>
            <div id="copyright-text" class="tracking-widest opacity-60 max-w-md mx-auto leading-relaxed border-t pt-6">
                © 2026 Lembaga IT & Infokom PAC Pagar Nusa Kecamatan Kemang - Kabupaten Bogor
            </div>
        </div>
    </footer>

<script>
    // GANTI DENGAN URL WEB APP GOOGLE SCRIPT ANDA
    const API_URL = 'https://script.google.com/macros/s/AKfycbxrjbI6ZzqcX4zurydbnqAo8GvNdsKzQ0nODvelWFJlPJGAjaUPw7u64CdMNaoZTvZ-/exec'; 
    let allNews = [];

    // Mobile Menu Toggle
    const toggle = document.getElementById('menu-toggle');
    const menu = document.getElementById('mobile-menu');
    const overlay = document.getElementById('overlay');
    const closeBtn = document.getElementById('close-menu');

    function toggleMenu() {
        menu.classList.toggle('-translate-x-full');
        overlay.classList.toggle('hidden');
    }

    toggle.onclick = toggleMenu;
    overlay.onclick = toggleMenu;
    closeBtn.onclick = toggleMenu;

    async function fetchContent() {
        try {
            const response = await fetch(API_URL);
            const res = await response.json();
            
            if (res.status !== "success") throw new Error(res.message);
            
            allNews = res.berita;

            // 1. Profil Sync (DISINKRONKAN DENGAN KEY BACKEND)
            if(res.profil) {
                // Key disesuaikan: alamat, wa, copyright (huruf kecil sesuai backend)
                document.getElementById('alamat-sekre').innerHTML = res.profil.alamat || "Alamat belum diatur di admin.";
                document.getElementById('copyright-text').innerText = res.profil.copyright || `© ${new Date().getFullYear()} PAC Pagar Nusa Kemang`;
                
                if(res.profil.wa) {
                    let waNum = res.profil.wa.toString().replace(/\D/g,'');
                    if(waNum.startsWith('0')) waNum = '62' + waNum.slice(1);
                    document.getElementById('btn-wa').href = `https://wa.me/${waNum}`;
                }
            }

            // 2. Navigation Render
            const navContainer = document.getElementById('main-nav');
            const mobileNav = document.getElementById('mobile-nav-list');
            navContainer.innerHTML = '';
            mobileNav.innerHTML = '';

            if(res.navigasi) {
                res.navigasi.forEach(menuItem => {
                    const label = menuItem[0];
                    const link = menuItem[1];
                    const isJoin = label.toLowerCase().includes('join');
                    
                    // Desktop
                    const li = document.createElement('li');
                    li.className = "px-6 py-4 hover:bg-green-800 transition-colors cursor-pointer group";
                    li.innerHTML = `<a href="${link}" class="${isJoin ? 'text-yellow-400 font-bold' : ''} block">${label}</a>`;
                    
                    if(link === '#' || link === '') {
                        li.onclick = (e) => {
                            e.preventDefault();
                            filterByCategory(label);
                        };
                    }
                    navContainer.appendChild(li);

                    // Mobile
                    const mLi = document.createElement('li');
                    mLi.className = "border-b border-white/10 pb-2";
                    mLi.innerHTML = `<a href="${link}">${label}</a>`;
                    if(link === '#' || link === '') {
                        mLi.onclick = (e) => {
                            e.preventDefault();
                            toggleMenu();
                            filterByCategory(label);
                        };
                    }
                    mobileNav.appendChild(mLi);
                });
            }

            renderBerita(allNews);

        } catch (error) { 
            console.error("Fetch Error:", error);
            document.getElementById('news-list').innerHTML = `
                <div class="p-8 bg-red-50 text-red-600 rounded-2xl text-center border border-red-100">
                    <p class="font-bold">Gagal Terhubung ke Pusat Data</p>
                    <small class="opacity-70">${error.message}</small>
                </div>`;
        }
    }

    function filterByCategory(catName) {
        const filtered = allNews.filter(n => n.kategori.toUpperCase() === catName.toUpperCase());
        document.getElementById('news-title-trigger').innerText = catName;
        renderBerita(filtered, true);
        window.scrollTo({top: 400, behavior: 'smooth'});
    }

    function renderBerita(data, isSearch = false) {
        const headlineGrid = document.getElementById('headline-grid');
        const newsList = document.getElementById('news-list');
        const opinionList = document.getElementById('opinion-list');
        const status = document.getElementById('search-status');

        if(!isSearch) headlineGrid.innerHTML = '';
        newsList.innerHTML = ''; 
        opinionList.innerHTML = '';
        status.innerText = isSearch ? `Ditemukan ${data.length} hasil` : '';

        if (data.length === 0) {
            newsList.innerHTML = '<div class="text-center py-20 opacity-30 uppercase font-bold tracking-widest">Konten Tidak Ditemukan</div>';
            return;
        }

        data.forEach((item, index) => {
            const detailLink = `detail.html?id=${item.id}`;
            const imgSrc = item.gambar || 'https://placehold.co/800x600/2d6a4f/ffffff?text=Pagar+Nusa';
            const cleanContent = item.isi ? item.isi.replace(/<[^>]*>?/gm, '') : '';

            // A. Headlines (2 Berita Pertama)
            if (!isSearch && index < 2) {
                headlineGrid.innerHTML += `
                    <a href="${detailLink}" class="relative h-[400px] bg-gray-900 overflow-hidden group rounded-2xl shadow-xl reveal">
                        <img src="${imgSrc}" class="w-full h-full object-cover opacity-70 transition duration-700 group-hover:opacity-100 group-hover:scale-110" loading="lazy">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 right-0 p-8 text-white">
                            <span class="bg-pn px-3 py-1 text-[10px] font-bold uppercase tracking-[0.2em] rounded-sm">${item.kategori}</span>
                            <h2 class="text-2xl md:text-3xl font-bold mt-3 group-hover:text-yellow-400 transition-colors leading-tight nav-font uppercase">${item.judul}</h2>
                            <p class="text-[10px] mt-3 opacity-70 uppercase tracking-widest font-bold flex items-center">${item.tanggal}</p>
                        </div>
                    </a>`;
            }

            // B. Sidebar (Opini/Khazanah)
            const cat = item.kategori.toLowerCase();
            if (cat.includes('opini') || cat.includes('khazanah')) {
                opinionList.innerHTML += `
                    <li class="py-5 group reveal">
                        <a href="${detailLink}" class="font-bold group-hover:text-pn transition-colors block text-gray-800 text-base mb-1">${item.judul}</a>
                        <div class="flex items-center justify-between mt-2">
                             <span class="text-[9px] text-gray-400 uppercase font-black">${item.tanggal}</span>
                             <span class="text-[9px] bg-gray-100 px-2 py-0.5 rounded text-gray-500 uppercase font-bold">${item.kategori}</span>
                        </div>
                    </li>`;
            } 
            
            // C. Main News List
            if (isSearch || index >= 2) {
                newsList.innerHTML += `
                    <a href="${detailLink}" class="news-card flex flex-col md:flex-row gap-6 border-b border-gray-100 pb-10 group reveal">
                        <div class="md:w-64 h-48 overflow-hidden rounded-2xl shadow-sm bg-gray-200 flex-shrink-0">
                            <img src="${imgSrc}" class="w-full h-full object-cover transition duration-700 group-hover:scale-110" loading="lazy">
                        </div>
                        <div class="flex-1 py-2">
                            <span class="text-pn font-bold text-[10px] tracking-[0.2em] uppercase bg-pn/10 px-2 py-1 rounded">${item.kategori}</span>
                            <h4 class="text-xl md:text-2xl font-bold mt-3 group-hover:text-green-700 transition-colors text-black nav-font uppercase">${item.judul}</h4>
                            <p class="text-gray-500 mt-3 text-sm line-clamp-2 leading-relaxed">${cleanContent}</p>
                            <div class="flex items-center mt-6 space-x-3">
                                <div class="w-8 h-8 bg-pn text-white rounded-full flex items-center justify-center text-[8px] font-black shadow-lg">PN</div>
                                <div>
                                    <p class="text-[9px] text-gray-900 font-bold uppercase tracking-widest">Redaksi PAC</p>
                                    <p class="text-[8px] text-gray-400 font-medium uppercase mt-0.5">${item.tanggal}</p>
                                </div>
                            </div>
                        </div>
                    </a>`;
            }
        });
        initScrollReveal();
    }

    // Search Logic
    document.getElementById('search-input').addEventListener('input', (e) => {
        const val = e.target.value.toLowerCase();
        if(val.length > 2) {
            const filtered = allNews.filter(n => 
                n.judul.toLowerCase().includes(val) || 
                n.kategori.toLowerCase().includes(val) ||
                (n.isi && n.isi.toLowerCase().includes(val))
            );
            document.getElementById('news-title-trigger').innerText = "Hasil Pencarian";
            renderBerita(filtered, true);
        } else if (val.length === 0) {
            document.getElementById('news-title-trigger').innerText = "Berita Terkini";
            renderBerita(allNews);
        }
    });

    // Scroll Reveal Animation
    function initScrollReveal() {
        const reveals = document.querySelectorAll('.reveal');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if(entry.isIntersecting) entry.target.classList.add('active');
            });
        }, { threshold: 0.1 });
        reveals.forEach(el => observer.observe(el));
    }

    document.addEventListener('DOMContentLoaded', fetchContent);
</script>
</body>
</html>
